<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Plataforma de streaming de canales en vivo - Deportes, Películas, Series, Documentales y más">
    <meta name="keywords" content="streaming, canales, tv en vivo, deportes, películas, series, m3u8, iptv">
    <meta name="author" content="Streaming Platform">
    <meta name="theme-color" content="#667eea">
    <meta name="format-detection" content="telephone=no">
    
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="assets/icons/favicon.svg">
    <link rel="alternate icon" href="assets/icons/favicon.svg">
    <link rel="mask-icon" href="assets/icons/favicon.svg" color="#667eea">
    
    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="assets/icons/favicon.svg">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Streaming">
    <link rel="apple-touch-startup-image" href="assets/icons/favicon.svg">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./public/manifest.json">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="M3U8 Streaming Platform">
    <meta property="og:description" content="Plataforma de streaming de canales en vivo">
    <meta property="og:image" content="./assets/icons/favicon.svg">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="M3U8 Streaming Platform">
    <meta name="twitter:description" content="Plataforma de streaming de canales en vivo">
    
    <title>M3U8 Streaming Platform</title>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="./src/css/styles.css">
    <link rel="stylesheet" href="./src/css/modal.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingPage">
        <div class="loading-spinner"></div>
        <div class="loading-text">Cargando canales...</div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <header>
            <h1>📺 Canales de Streaming</h1>
            
            <!-- Language Switcher -->
            <div style="position: absolute; top: 10px; left: 10px;">
                <a href="./index-en.html" style="color: white; text-decoration: none; padding: 8px 12px; background: rgba(255,255,255,0.2); border-radius: 5px; font-size: 14px; font-weight: 600;">
                    🇬🇧 English
                </a>
            </div>
            
            <!-- Parental Control Button -->
            <button id="parentalBtn" onclick="toggleControlParental()" 
                    title="Control Parental" aria-label="Control Parental">
                🔒
            </button>
            
            <!-- Search Box -->
            <div class="search-box">
                <input type="text" id="searchInput" 
                       placeholder="🔍 Buscar canal..." 
                       autocomplete="off" 
                       autocorrect="off" 
                       autocapitalize="off" 
                       spellcheck="false"
                       aria-label="Buscar canales">
            </div>
        </header>

        <!-- Controls Bar -->
        <div class="controls-bar">
            <button class="control-btn" onclick="expandAllCategories()" aria-label="Expandir todas las categorías">
                📂 Expandir
            </button>
            <button class="control-btn" onclick="collapseAllCategories()" aria-label="Colapsar todas las categorías">
                📁 Colapsar
            </button>
            <button class="control-btn" onclick="openPlaylistModal()" aria-label="Cargar lista M3U">
                📥 Cargar Lista M3U
            </button>
            <span class="control-btn" style="cursor: default; font-size: 14px;" aria-label="Total de canales">
                📊 <span id="totalChannels">0</span> canales
            </span>
        </div>

        <!-- Channels Container -->
        <div id="channelsContainer"></div>
        
        <!-- No Results Message -->
        <div class="no-results" id="noResults">No se encontraron canales</div>
        
            <!-- Footer -->
            <footer style="text-align: center; padding: 30px 20px; margin-top: 40px; border-top: 1px solid rgba(255,255,255,0.1); opacity: 0.7;">
                <p style="margin: 0; font-size: 14px;">
                    Hecho con ❤️ por <a href="https://github.com/Kl4rkx" target="_blank" rel="noopener noreferrer" style="color: #667eea; text-decoration: none; font-weight: 600;">Kl4rkx</a>
                </p>
                <p style="margin: 5px 0 0 0; font-size: 12px; opacity: 0.8;">
                    <a href="https://github.com/Kl4rkx/free-iptv-player" target="_blank" rel="noopener noreferrer" style="color: #667eea; text-decoration: none;">Free IPTV Player</a> - 100% Legal & Open Source
                </p>
            </footer>
    </div>

    <!-- Video Player Modal -->
    <div class="video-modal" id="videoModal" role="dialog" aria-modal="true" aria-label="Reproductor de video">
        <div class="video-container">
            <button class="close-button" onclick="closeVideo()" aria-label="Cerrar reproductor">
                ✕ Cerrar
            </button>
            <div class="loading-indicator" id="loadingIndicator">⏳ Cargando stream...</div>
            <video id="videoPlayer" 
                   controls 
                   autoplay 
                   playsinline 
                   webkit-playsinline 
                   x5-playsinline
                   aria-label="Video player"></video>
        </div>
    </div>

    <!-- Playlist Loader Modal -->
    <div class="playlist-modal" id="playlistModal" role="dialog" aria-modal="true" aria-label="Cargar lista de canales">
        <div class="playlist-content">
            <div class="playlist-header">
                <h2>📥 Cargar Lista de Canales</h2>
                <button class="playlist-close" onclick="closePlaylistModal()" aria-label="Cerrar modal">
                    ✕
                </button>
            </div>

            <!-- Tabs -->
            <div class="tabs-container" role="tablist">
                <button class="tab-btn active" onclick="switchTab('url')" role="tab" aria-selected="true">
                    🌐 Desde URL
                </button>
                <button class="tab-btn" onclick="switchTab('file')" role="tab" aria-selected="false">
                    📁 Archivo Local
                </button>
                <button class="tab-btn" onclick="switchTab('repo')" role="tab" aria-selected="false">
                    📂 Repositorio
                </button>
            </div>

            <!-- Tab: From URL -->
            <div class="tab-content active" id="tab-url" role="tabpanel">
                <div class="input-group">
                    <label for="urlInput">URL de la lista M3U/M3U8:</label>
                    <input type="url" id="urlInput" placeholder="https://ejemplo.com/lista.m3u8" 
                           aria-label="URL de la lista">
                </div>
                <div class="input-group">
                    <label for="urlCategory">Categoría por defecto (opcional):</label>
                    <input type="text" id="urlCategory" placeholder="Ej: deportes, peliculas..." 
                           aria-label="Categoría por defecto">
                </div>
                <button class="load-btn" onclick="loadFromURL()" aria-label="Cargar desde URL">
                    ⬇️ Cargar desde URL
                </button>
                <div class="status-message" id="urlStatus" role="status"></div>
            </div>

            <!-- Tab: From File -->
            <div class="tab-content" id="tab-file" role="tabpanel">
                <div class="input-group">
                    <label for="fileInput">Selecciona un archivo M3U/M3U8:</label>
                    <div class="file-input-wrapper">
                        <label class="file-input-label">
                            <input type="file" id="fileInput" accept=".m3u,.m3u8" onchange="updateFileName()" 
                                   aria-label="Seleccionar archivo">
                            <span id="fileName">📄 Click para seleccionar archivo</span>
                        </label>
                    </div>
                </div>
                <div class="input-group">
                    <label for="fileCategory">Categoría por defecto (opcional):</label>
                    <input type="text" id="fileCategory" placeholder="Ej: deportes, peliculas..." 
                           aria-label="Categoría por defecto">
                </div>
                <button class="load-btn" onclick="loadFromFile()" aria-label="Cargar desde archivo">
                    ⬇️ Cargar desde archivo
                </button>
                <div class="status-message" id="fileStatus" role="status"></div>
            </div>

            <!-- Tab: From Repository -->
            <div class="tab-content" id="tab-repo" role="tabpanel">
                <div class="input-group">
                    <label>Listas disponibles en el repositorio:</label>
                    <div class="repo-list" role="listbox">
                        <div class="repo-item" onclick="selectRepoFile('data/canales-tv.m3u8')" role="option">
                            📺 canales-tv.m3u8
                            <span style="font-size: 12px; opacity: 0.7;">TV en vivo</span>
                        </div>
                        <div class="repo-item" onclick="selectRepoFile('data/listam3u8.m3u8')" role="option">
                            📡 listam3u8.m3u8
                            <span style="font-size: 12px; opacity: 0.7;">Lista principal</span>
                        </div>
                        <div class="repo-item" onclick="selectRepoFile('data/canales.m3u')" role="option">
                            📋 canales.m3u
                            <span style="font-size: 12px; opacity: 0.7;">Canales generales</span>
                        </div>
                        <div class="repo-item" onclick="selectRepoFile('data/mascanales.m3u')" role="option">
                            ➕ mascanales.m3u
                            <span style="font-size: 12px; opacity: 0.7;">Canales adicionales</span>
                        </div>
                    </div>
                </div>
                <input type="hidden" id="selectedRepoFile">
                <button class="load-btn" onclick="loadFromRepo()" id="repoLoadBtn" disabled 
                        aria-label="Cargar lista seleccionada">
                    ⬇️ Cargar lista seleccionada
                </button>
                <div class="status-message" id="repoStatus" role="status"></div>
            </div>
        </div>
    </div>

    <!-- External Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    
    <!-- Demo Channels - 100% Legal & Ethical Content -->
    <script src="./data/canales-demo.js"></script>
    
    <!-- App Scripts (ES6 Modules) -->
    <script type="module" src="./src/js/app.js"></script>
</body>
</html>
